-- CENTRU DEPOZITARE
CREATE TABLE CentruDepozitare (
    centru_id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    locatie VARCHAR2(50),
    capacitate NUMBER,
    curier_id NUMBER,
    pachet_id NUMBER
);

-- SOFER
CREATE TABLE Sofer (
    sofer_id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    denumire_sofer VARCHAR2(255),
    experienta_livrare NUMBER,
    telefon VARCHAR2(15),
    centru_id NUMBER
);

-- TRANSPORTURI
CREATE TABLE Transporturi (
    transporturi_id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    status VARCHAR2(50),
    data_preluare DATE,
    ora_preluare TIMESTAMP,
    data_descarcare DATE,
    ora_descarcare TIMESTAMP,
    mod_transport VARCHAR2(50),
    sofer_id NUMBER,
    pachet_id NUMBER
);

-- LOCATIE
CREATE TABLE Locatie (
    locatie_id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    denumire_locatie VARCHAR2(35),
    coordonate_gps VARCHAR2(20),
    centru_id NUMBER
);

-- PACHET–DEPOZIT–TRANSPORTURI
CREATE TABLE PachetDepozitTransporturi (
    transporturi_id NUMBER,
    centru_id NUMBER,
    PRIMARY KEY (transporturi_id, centru_id)
);

-- TRANSPORTURI EFECTUATE
CREATE TABLE TransporturiEfectuate (
    transporturi_id NUMBER,
    sofer_id NUMBER,
    id_depozit_plecare NUMBER,
    id_depozit_sosire NUMBER,
    PRIMARY KEY (transporturi_id,sofer_id)
);
------------------------------------------------------------------------------
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Cluj-Napoca', 500, 1, 1);
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Bucuresti', 700, 2, 2);
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Timisoara', 600, 3, 3);
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Iasi', 450, 4, 4);
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Brasov', 550, 5, 5);
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Constanta', 400, 6, 6);
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Oradea', 300, 7, 7);
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Sibiu', 350, 8, 8);
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Ploiesti', 500, 9, 9);
INSERT INTO CentruDepozitare (locatie, capacitate, curier_id, pachet_id) VALUES ('Arad',450,10,10);

INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Ion Popescu', 5, '0712345678', 1);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Maria Ionescu', 3, '0722233445', 2);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('George Vasilescu', 7, '0733445566', 3);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Ana Petrescu', 4, '0744556677', 4);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Lucian Georgescu', 6, '0755667788', 5);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Elena Tudor', 2, '0766778899', 6);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Andrei Mihai', 8, '0777888999', 7);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Laura Dobre', 3, '0788990011', 8);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Cristian Stan', 5, '0799001122', 9);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Irina Florescu', 4, '0700112233',10);

INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Ion Popescu', 5, '0712345678', 1);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Maria Ionescu', 3, '0722233445', 2);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('George Vasilescu', 7, '0733445566', 3);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Ana Petrescu', 4, '0744556677', 4);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Lucian Georgescu', 6, '0755667788', 5);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Elena Tudor', 2, '0766778899', 6);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Andrei Mihai', 8, '0777888999', 7);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Laura Dobre', 3, '0788990011', 8);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Cristian Stan', 5, '0799001122', 9);
INSERT INTO Sofer (denumire_sofer, experienta_livrare, telefon, centru_id) VALUES ('Irina Florescu', 4, '0700112233',10);

INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('In curs', TO_DATE('2025-03-01', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-02', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Duba', 1, 1);
INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('Finalizat', TO_DATE('2025-03-02', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-03', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Camion', 2, 2);
INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('Anulat', TO_DATE('2025-03-03', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-04', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Masina', 3, 3);
INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('In curs', TO_DATE('2025-03-04', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-05', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Duba', 4, 4);
INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('Finalizat', TO_DATE('2025-03-05', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-06', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Camioneta', 5, 5);
INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('In curs', TO_DATE('2025-03-06', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-07', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Motocicleta', 6, 6);
INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('Finalizat', TO_DATE('2025-03-07', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-08', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Duba', 7, 7);
INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('Anulat', TO_DATE('2025-03-08', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-09', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Camion', 8, 8);
INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('In curs', TO_DATE('2025-03-09', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-10', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Masina', 9, 9);
INSERT INTO Transporturi (status, data_preluare, ora_preluare, data_descarcare, ora_descarcare, mod_transport, sofer_id, pachet_id) VALUES ('Finalizat', TO_DATE('2025-03-10', 'YYYY-MM-DD'), SYSTIMESTAMP, TO_DATE('2025-03-11', 'YYYY-MM-DD'), SYSTIMESTAMP, 'Duba',10,10);

INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Cluj', '46.77,23.59', 1);
INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Bucuresti', '44.43,26.10', 2);
INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Timisoara', '45.75,21.23', 3);
INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Iasi', '47.16,27.59', 4);
INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Brasov', '45.65,25.60', 5);
INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Constanta', '44.17,28.63', 6);
INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Oradea', '47.05,21.92', 7);
INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Sibiu', '45.79,24.15', 8);
INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Ploiesti', '44.94,26.03', 9);
INSERT INTO Locatie (denumire_locatie, coordonate_gps, centru_id) VALUES ('Depozit Arad', '46.17,21.31',10);

INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id) VALUES (1,1);
INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id) VALUES (2,2);
INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id) VALUES (3,3);
INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id)VALUES (4,4);
INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id) VALUES (5,5);
INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id) VALUES (6,6);
INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id) VALUES (7,7);
INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id) VALUES (8,8);
INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id) VALUES (9,9);
INSERT INTO PachetDepozitTransporturi (transporturi_id, centru_id)VALUES (10,10);

INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (1,1,1,2);
INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (2,2,2,3);
INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (3,3,3,4);
INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (4,4,4,5);
INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (5,5,5,6);
INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (6,6,6,7);
INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (7,7,7,8);
INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (8,8,8,9);
INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (9,9,9,10);
INSERT INTO TransporturiEfectuate (transporturi_id, sofer_id, id_depozit_plecare, id_depozit_sosire) VALUES (10,10,10,1);
-------------------------------------------------------------------------------------------------------------------------------
SELECT 
    c.denumire_client,
    p.pachet_id,
    ot.status AS status_transport,
    os.denumire_sofer,
    ot.data_preluare,
    ot.mod_transport
FROM 
    Client c
JOIN 
    Pachet p ON c.pachet_id = p.pachet_id
JOIN 
    oracle_transporturi ot ON p.pachet_id = ot.pachet_id
JOIN 
    oracle_sofer os ON ot.sofer_id = os.sofer_id
WHERE 
    ot.status = 'Finalizat'
ORDER BY 
    ot.data_preluare DESC;